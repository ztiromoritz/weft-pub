<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Static Template</title>
    <meta name="description" content="Chatter">
    <meta name="author" content="Moritz Rebbert">
    <style>*,:after,:before{box-sizing:border-box;margin:0;padding:0}body,html{background:#000;height:100%}#error-message{display:none;background-color:red;color:#fff;font-weight:700;padding:10px;min-height:50px;font-size:80px}#error-message.show{display:block}</style>
    <style>@keyframes shadowPulse{0%,to{box-shadow:0 0 0 0 rgba(0,0,0,.2)}50%{box-shadow:0 0 0 10px rgba(0,0,0,.2)}}@keyframes colorPulse{0%,to{background:#696969}50%{background:#4b4b4b}}@keyframes blink{50%{opacity:1}}.chat-size{width:100%;height:100%}.chat{background:#fff;margin:0 auto;display:flex;flex-direction:column}.chat footer,.chat header{width:100%;height:120px;background:#000}.chat main{flex:1;padding:0 30px;overflow:scroll}.chat main:after{content:"";display:block;height:100px;width:100%;clear:both}.chat footer{position:relative}.chat .answer{width:100%;min-height:130px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:50px;background-color:#d3d3d3;display:flex;flex-direction:row}.chat .answer .content{flex:1;margin:20px;min-height:100px;border-radius:5px;background-color:#fff}.chat .answer .send{margin-top:20px;margin-right:10px;width:100px;height:100px;background-color:#696969;border-radius:50px}.chat .glow,.chat .options>div{animation-name:shadowPulse;animation-duration:1.5s;animation-iteration-count:8;animation-timing-function:linear}.chat .answer .send img,.chat .answer .send svg{display:block;margin:15px 9px;width:70px;height:70px}.chat .options{width:100%;background:#696969;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:0;color:transparent}.chat .options.show{font-size:50px;color:#fff;transition:font-size .25s,color .25s .25s}.chat .options.hide{font-size:0;color:transparent;transition:font-size .25s .25s,color .25s}.chat .options>div{animation-name:colorPulse;border-bottom:1px solid #fff;padding:20px}.chat .options>div:nth-child(odd){animation-delay:.75s}.chat .message{max-width:85%;clear:both}.chat .message.me .time,.chat .message.other{float:left}.chat .message.me,.chat .message.other .time{float:right}.chat .message .content,.chat .message .time{font-size:50px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.chat .message .time{display:none;font-size:30px;color:gray}.chat .bbl-left,.chat .bbl-right,.chat .message{margin-top:40px;padding:0 20px;position:relative;border-radius:.4em;transition:width 10s,height 2s}.chat .message.me{background:#05bb6f}.chat .message.other{background:#00dff2}.chat .bbl-left:after,.chat .bbl-right:after,.chat .message.me:after,.message.other:after{content:'';position:absolute;top:50%;width:0;height:0;border:35px solid transparent;border-top:0;margin-top:-10px}.chat .bbl-right:after,.chat .message.me:after{right:0;border-left-color:#05bb6f;border-right:0;margin-right:-20px}.chat .bbl-left:after,.message.other:after{left:0;border-right-color:#00dff2;border-left:0;margin-left:-20px}.chat .typing{height:.5em;vertical-align:middle}.chat .typing span{height:15px;width:15px;float:left;margin:.5em 1px;background-color:#006400;display:block;border-radius:50%;opacity:.4}.chat .typing span:nth-of-type(1){animation:1s blink infinite .3333s}.chat .typing span:nth-of-type(2){animation:1s blink infinite .6666s}.chat .typing span:nth-of-type(3){animation:1s blink infinite 1s}</style>
    <meta name="apple-mobile-web-app-capable" content="yes">

</head>

<body>
<div class="chat chat-size">
    <header></header>
    <div id="error-message"></div>
    <main id="chat"></main>
    <div class="options"></div>
    <div class="answer">
        <div class="content" id="answerInput"></div>
        <div class="send" id="answerButton"><svg fill="white" width="14" height="14" viewBox="0 0 14 14">
<path d="M13.781 0.086q0.258 0.187 0.211 0.5l-2 12q-0.039 0.227-0.25 0.352-0.109 0.062-0.242 0.062-0.086 0-0.187-0.039l-3.539-1.445-1.891 2.305q-0.141 0.18-0.383 0.18-0.102 0-0.172-0.031-0.148-0.055-0.238-0.184t-0.090-0.285v-2.727l6.75-8.273-8.352 7.227-3.086-1.266q-0.289-0.109-0.312-0.43-0.016-0.312 0.25-0.461l13-7.5q0.117-0.070 0.25-0.070 0.156 0 0.281 0.086z"></path>
</svg></div>
    </div>
    <footer></footer>

    <!-- $DIALOG_PLACE_HOLDER$ -->

    <!-- $INTERNAL_DATA_START$ $WEFT_INTERNAL_DATA$ $INTERNAL_DATA_END$ -->

    <script src="https://cdn.polyfill.io/v2/polyfill.js?features=Promise"></script>
    <script>!function(t,n){"object"==typeof exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):t.lmn=n()}(this,function(){"use strict";function t(t){return E.call(t)===o}function n(t){for(var n="",e=0;e<t.length;e++)n+=E.call(t[e]);return n}function e(t){if(!t)throw new Error(d.INVALID_DATA+": Empty data");var n=t.dialog;if(!n)throw new Error(d.INVALID_DATA+": No dialog in data");if(!function(t){return E.call(t)===r}(n))throw new Error(d.INVALID_DATA+": Dialog is not an array");return n}var i=function(){this.dialogs=Object.create(null)},r="[object Array]",o="[object Number]",s="[object String]",u=Object.create(null),p=s,a=s+s,c=s+s+s,l=s+r,f=s+r+s,h=s+s+r,O=s+s+r+s,N=s+s,d={INVALID_DATA:"INVALID_DATA",INVALID_COMMAND:"INVALID_COMMAND",INVALID_OPTION:"INVALID_OPTION",NO_LABEL_FOR_NEXT:"NO_LABEL_FOR_NEXT",NO_SUCH_LABEL:"NO_SUCH_LABEL",DUPLICATED_LABEL:"DUPLICATED_LABEL",NO_SUCH_DIALOG:"NO_SUCH_DIALOG"},E=Object.prototype.toString;i.prototype.addDialog=function(i,r){var o=e(r),s=Object.create(null);o.forEach(function(e,i){if(function(t){return t!==p&&t!==l&&t!==f}(function(t,e){var i=n(t);if(i===p||i===a||i===c||i===l||i===f||i===h||i===O)return i;throw new Error(d.INVALID_COMMAND+": Invalid Command ["+t+"] type ["+i+"] in ["+e+"]")}(e,i))){var r=e[0];!function(n,e,i,r){if(t(n[e]))throw new Error(d.DUPLICATED_LABEL+": Duplicated label ["+e+"] in command "+r+"  ["+JSON.stringify(i)+"]")}(s,r,e,i),s[r]=i}}),s["???"]=-1,o.forEach(function(e,i){var r=null,o=[],u=n(e);c===u?r=e[2]:l===u?o=e[1]:f===u?(r=e[2],o=e[1]):h===u?o=e[2]:O===u&&(r=e[3],o=e[2]),r&&function(n,e,i,r){if(!t(n[e]))throw new Error(d.NO_LABEL_FOR_NEXT+": No label found for next value in command "+r+" ["+JSON.stringify(i)+"]")}(s,r,e,i),o.forEach(function(e,r){!function(t,e,i){var r=n(t);if(r!==N)throw new Error(d.INVALID_OPTION+": Invalid Option ["+t+"] type ["+r+"] in command ["+e+"] option ["+i+"]")}(e,i,r),function(n,e,i,r){if(!t(n[e[1]]))throw new Error(d.NO_LABEL_FOR_NEXT+": No label found for next value in option ["+r+"] command ["+i+"] :"+JSON.stringify(e))}(s,e,i,r)})}),this.dialogs[i]={commands:o,labels:s}};var g=function(t){this.currentStep=0,this.pendingOptions=null,this.usedOptions={},this.dialog=t};g.prototype.next=function(t){if(this.pendingOptions){if("number"!=typeof t)return this.pendingOptions;var e=this.pendingOptions.options[t][1];this.usedOptions[this.currentStep]=this.usedOptions[this.currentStep]||Object.create(null),this.usedOptions[this.currentStep][t]=!0,this.currentStep=this.dialog.labels[e],this.pendingOptions=null}if(this.currentStep>=this.dialog.commands.length)return new A(A.Type.END);if(-1===this.currentStep)return new A(A.Type.UNFINSHED_DIALOG);var i=this.dialog.commands[this.currentStep],r=n(i);if(p===r)return this.currentStep++,new A(A.Type.MESSAGE,i[0]);if(a===r)return this.currentStep++,new A(A.Type.MESSAGE,i[1]);if(c===r)return this.currentStep=this.dialog.labels[i[2]],new A(A.Type.MESSAGE,i[1]);if(h===r)return this.pendingOptions=new A(A.Type.QUESTION,i[1],i[2]),this.pendingOptions;if(l===r)return this.pendingOptions=new A(A.Type.QUESTION,i[0],i[1]),this.pendingOptions;if(O===r||f===r){var o,s,N;O===r&&(o=i[1],s=i[2],N=i[3]),f===r&&(o=i[0],s=i[1],N=i[2]);for(var d=this.usedOptions[this.currentStep]||u,E=[],g=0;g<s.length;g++)d[g]?E[g]=!1:E[g]=s[g];return E.reduce(function(t,n){return n?t+1:t},0)>0?(this.pendingOptions=new A(A.Type.QUESTION,o,E),this.pendingOptions):(this.currentStep=this.dialog.labels[N],this.next())}},g.prototype.selectStepByLabel=function(t){var n=this.dialog.labels[t];if(!Number.isInteger(n))throw new Error(d.NO_SUCH_LABEL+": No step exists with label: "+t);this.currentStep=n};var A=function(t,n,e){this.type=t,this.content=n,this.options=e};A.Type={END:0,MESSAGE:1,QUESTION:2,UNFINISHED_DIALOG:3},A.prototype.getType=function(){return this.type},A.prototype.getContent=function(){return this.content},A.prototype.getAvailableOptions=function(){return this.options.map(function(t,n){return t?t.slice().concat(n):null}).filter(function(t){return!!t}).map(function(t){return new S(t[0],t[1],t[2])})};var S=function(t,n,e){this.content=t,this.next=n,this.label=e};return S.prototype.getContent=function(){return this.content},S.prototype.getNext=function(){return this.next},S.prototype.getLabel=function(){return this.label},i.prototype.startDialog=function(t){if(!this.dialogs[t])throw new Error(d.NO_SUCH_DIALOG+": No such dialog exists: "+t);var n=function(t){return JSON.parse(JSON.stringify(t))}(this.dialogs[t]);return new g(n)},i.prototype.listDialogs=function(){return Object.getOwnPropertyNames(this.dialogs)},{Step:A,DialogStore:i,ERROR_CODE:d}});</script>
    <script>!function(n,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):n.bubble=t()}(this,function(){return function(n,t){var e="";e=(t=t||{}).grow?"display: none;":"visibility: hidden;";var o={},i=n.innerText;return o.step=function(){var t=n.children,e=t[0].cloneNode(!0),o=t[1].cloneNode(!0),i=e.textContent,s=o.textContent;return e.textContent=i+s.substr(0,1),o.textContent=s.substr(1),n.innerHTML="",n.appendChild(e),n.appendChild(o),s.substr(1).length>0},o.start=function(n,t){t="number"==typeof t?t:22;var e=function(){setTimeout(function(){o.step()?e():"function"==typeof n&&n()},t)};e()},o.reset=function(){n.innerHTML='<span class="show"></span><span class="hide" style="'+e+'">'+i.trim()+"</span>"},o.reset(),o}});</script>
    <script>!function(e,n){"object"==typeof exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):e.chatter=n()}(this,function(){"use strict";function e(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")}function n(e,n){e.classList?e.classList.add(n):e.className+=" "+n}function t(e,n,t){var o=[];n.map(function(e){var n=document.createElement("div");n.innerHTML=e.getContent();var s=function(){o.forEach(function(e){e()}),"function"==typeof t&&t(e.getLabel())};return n.addEventListener("click",s),o.push(function(){n.removeEventListener("click",s)}),n}).forEach(function(n){e.appendChild(n)})}var o={},s=document.querySelector("#chat"),r=/<<([^\s]*) "([^"]*)">>/;o.showOptions=function(s){return console.log("show options"),new Promise(function(r){var i=document.querySelector(".options");t(i,s,function(e){o.hideOptions(),r(e)}),n(i,"show"),e(i,"hide");var a=function(){i.removeEventListener("transitionend",a)};i.addEventListener("transitionend",a)})},o.hideOptions=function(){return new Promise(function(t){var o=document.querySelector(".options");n(o,"hide"),e(o,"show");var s=function(){o.innerHTML="",o.removeEventListener("transitionend",s),t(o)};o.addEventListener("transitionend",s)})},o.addMessage=function(t,o){var r=document.getElementById("answerInput"),i=document.getElementById("answerButton"),a=document.createElement("div");a.classList.add("message"),a.classList.add(t.user),s.scrollTop=s.scrollHeight;new Promise(function(o){if("me"===t.user){var c=document.createElement("span");c.innerHTML=t.content;var d=bubble(c,{grow:!0});r.appendChild(c);var l=function(){e(i,"glow"),i.removeEventListener("click",l),s.appendChild(a),c.innerHTML="",o()};d.start(function(){n(i,"glow"),i.addEventListener("click",l)},30)}else a.innerHTML='<div class="content typing"><span></span><span></span><span></span></div>',s.appendChild(a),setTimeout(o,t.typing)}).then(function(){console.log("write message"),a.innerHTML='<div class="user"></div><div class="content">'+t.content+"</div>",s.scrollTop=s.scrollHeight,"function"==typeof o&&o()})},o.showErrorMessage=function(e){var t=document.getElementById("error-message");t.innerHTML=e,n(t,"show"),t.addEventListener("click",o.hideErrorMessage)},o.hideErrorMessage=function(){var n=document.getElementById("error-message");n.removeEventListener("click",o.hideErrorMessage),e(n,"show")};var i=lmn.Step.Type,a=new lmn.DialogStore;if("undefined"!=typeof CHATTER_DIALOG){a.addDialog("default",CHATTER_DIALOG);var c=a.startDialog("default"),d=function(e){var n=c.next(e);switch(console.log(n),n.getType()){case i.MESSAGE:var t=function(e){var n=r.exec(e);return console.log(e,n),{user:"me"===n[1].toLowerCase()?"me":"other",content:n[2]}}(n.getContent());o.addMessage({user:t.user,content:t.content,typing:1500},function(e,n){return function(){setTimeout(n,e)}}(1500,d));break;case i.QUESTION:o.showOptions(n.getAvailableOptions()).then(function(e){d(e)});break;case i.END:case i.UNFINISHED_DIALOG:}};try{c.selectStepByLabel("Start"),d()}catch(e){o.showErrorMessage(e.message),console.error(e)}}return o});</script>
</div>
</body>
</html>